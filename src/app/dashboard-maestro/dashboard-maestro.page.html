<!-- AGM 30/01/2024 - Menú deslizante del maestro --> 
<ion-menu side="end" contentId="teacher-dashboard-content" menuId="teacher-main">
  <ion-header>
    <ion-avatar class="avatar-right">
      <img alt="Silhouette of a person's head" src="https://ionicframework.com/docs/img/demos/avatar.svg" />
    </ion-avatar>
  </ion-header>
  <ion-content class="ion-padding ion-text-right"> 
    <h1>Usuario</h1>
    <h5 (click)="goToProfile()">Visualizar o ver perfil</h5>
    <h5 (click)="logOut()">Cerrar sesión</h5>

    <h1>Grupos</h1>
    <h5 (click)="setFifthOpen(true)">Ver o gestionar mis grupos</h5>
    <h5 (click)="setOpen(true)">Registrar un grupo</h5>

    <h1>Alumnos</h1>
    <h5 (click)="setSecondOpen(true)">Registrar un alumno</h5>
    <h5 (click)="setThirdOpen(true)">Registrar varios alumnos</h5>
    <h5 (click)="setFourthOpen(true)">Alumnos registrados por mí</h5>

    <h1>Ayuda</h1>
    <h5>Preguntas frecuentes</h5>
    <h5>Reportes o sugerencias</h5>
  </ion-content>
</ion-menu>

<!-- AGM 30/01/2024 - Contenido principal --> 
<ion-content [fullscreen]="true">
  <div id="teacher-dashboard-content"> 

    <ion-refresher slot="fixed" [pullFactor]="0.5" [pullMin]="100" [pullMax]="200" (ionRefresh)="handleRefresh()">
      <ion-refresher-content></ion-refresher-content>
    </ion-refresher>
    <!-- AGM 30/01/2024 - Mensaje de bienvenida al maestro --> 
    <b><h1 class="welcome-message">Bienvenido {{ username }}</h1></b>

    <!-- AGM 30/01/2024 - Recuadro de inscripcion al grupo --> 
    <ion-card class="fixed-margin">
      <ion-card-header>
        <ion-card-title>¡Registra un grupo!</ion-card-title>
      </ion-card-header>
    
      <ion-card-content>
        Si aún no sabes cómo registrar un grupo, puedes pulsar el botón de abajo.
        <br>
        <ion-button class="fixed-button" (click)="setOpen(true)">Registrar a un grupo</ion-button>
      </ion-card-content>
    </ion-card>
    
    <b><h3 class="groups-message">Tus grupos:</h3></b>

    <!-- AGM 30/01/2024 - Cartas de los grupos creados por el maestro --> 
    <ion-card color="light" class="fixed-margin-card" *ngFor="let grupo of grupos">
      <div class="icon-container">
        <ion-icon name="people-outline" class="icon-size"></ion-icon>
      </div>
      
      <div class="text-container">
        <ion-card-header class="ion-text-center">
          <ion-text color="primary">
            <ion-card-title>{{ grupo.nombre }}</ion-card-title>
          </ion-text>
        </ion-card-header>
      
        <ion-card-content class="ion-text-center">
          {{ grupo.descripcion }}
        </ion-card-content>
      </div>
    
      <div class="icon-container-v2">
        <ion-icon name="chevron-forward-outline" class="icon-size-v2" (click)="goToGroup(grupo.id)"></ion-icon>
      </div>
    </ion-card>

    <ion-card color="light" class="fixed-margin-card" *ngIf="grupos.length === 0">
      <ion-card-content class="ion-text-center">
        No tienes ningún grupo registrado, si crees que se trata de un error, consulta la opción de ayuda para más detalles.
      </ion-card-content>
    </ion-card>

    <!-- AGM 30/01/2024 - Modal para registrar un grupo -->
    <ion-modal [isOpen]="isModalOpen">
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-icon name="arrow-back-outline" class="icon-modal-left" (click)="setOpen(false)"></ion-icon>
          </ion-toolbar>
        </ion-header>
        <ion-content class="ion-padding ion-text-center">
          <h1>Registro de un grupo</h1>

          <ion-item class="separator">
            <ion-input placeholder="Nombre del grupo" [(ngModel)]="groupName"></ion-input>
          </ion-item>
          
          <ion-item>
            <ion-textarea placeholder="Descripción del grupo" [(ngModel)]="groupDescription"></ion-textarea>
          </ion-item>

          <ion-text class="ion-text-center" color="danger" *ngIf="message">
            <p>{{ message }}</p>
          </ion-text>
        
          <ion-button class="btn-cancelar" (click)="setOpen(false)" color="danger">Cancelar</ion-button>
          <ion-button class="btn-registrar" (click)="createGroup()" color="primary">Registrar</ion-button>          
        </ion-content>
      </ng-template>
    </ion-modal>

    <!-- AGM 30/01/2024 - Modal para registrar un alumno al sistema -->
    <ion-modal [isOpen]="isSecondModalOpen">
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-icon name="arrow-back-outline" class="icon-modal-left" (click)="setSecondOpen(false)"></ion-icon>
            <ion-icon name="document-text" class="icon-modal-right" (click)="handleDocumentIconClick()"></ion-icon>
          </ion-toolbar>
        </ion-header>
        <ion-content class="ion-padding ion-text-center">
          <h1>Registro de un alumno en el sistema</h1>

          <ion-item class="separator">
            <ion-input placeholder="Nombre del alumno" [(ngModel)]="studentUsername"></ion-input>
          </ion-item>

          <ion-item>
            <ion-input type="password" placeholder="Contraseña del alumno" [(ngModel)]="studentPassword"></ion-input>
          </ion-item>

          <div>
            <ion-text color="danger" *ngIf="errorMessage">{{ errorMessage }}</ion-text>
          </div>
          
          <ion-button class="btn-cancelar" (click)="setSecondOpen(false)" color="danger">Cancelar</ion-button>
          <ion-button class="btn-registrar" (click)="registerStudent()" color="primary">Registrar</ion-button>
        </ion-content>
      </ng-template>
    </ion-modal>

    <!-- AGM 30/01/2024 - Modal para registrar alumnos en el sistema con txt -->
    <ion-modal [isOpen]="isThirdModalOpen">
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-icon name="arrow-back-outline" class="icon-modal-left" (click)="setThirdOpen(false)"></ion-icon>
            <!-- AGM 30/01/2024 - Falta desarrollar y definir qué es lo que vendrá en el recuadro de ayuda -->
            <ion-icon name="help-circle-outline" class="icon-modal-right" (click)="helpAlert()"></ion-icon>
          </ion-toolbar>
        </ion-header>
        
        <ion-content class="ion-padding ion-text-center">
          <h1>Registro de alumnos mediante un archivo de texto (.txt)</h1>
          
          <!-- AGM 30/01/2024 - Falta ver cómo se manejaran los delimitadores entre cada registro del alumno -->
          <ion-item class="separator">
            <input type="file" #fileInput accept=".txt" style="display: none;" (change)="handleFileInput($event)">
            <ion-button color="medium" (click)="fileInput.click()">{{ fileName || 'Seleccionar archivo .txt' }}</ion-button>
          </ion-item>          
        
          <ion-button class="btn-cancelar" (click)="setThirdOpen(false)" color="danger">Cancelar</ion-button>
          <ion-button class="btn-registrar" (click)="setThirdOpen(false)" color="primary">Registrar</ion-button>
        </ion-content>
      </ng-template>
    </ion-modal>

    <!-- AGM 30/01/2024 - Modal para mostrar los alumnos registrados en el sistema -->
    <ion-modal [isOpen]="isFourthModalOpen">
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-icon name="arrow-back-outline" class="icon-modal-left" (click)="setFourthOpen(false)"></ion-icon>
          </ion-toolbar>
        </ion-header>
        
        <ion-content class="ion-padding ion-text-center">
          <h1 class="fixed-title-modal">Alumnos registrados por mí</h1>
          
          <ion-card color="light" class="fixed-margin-card-modal">
            <div class="icon-container">
              <ion-icon name="accessibility" class="icon-size"></ion-icon>
            </div>
            
            <div class="text-container">
              <ion-card-header class="ion-text-center">
                <ion-card-subtitle>Alejandro Guerrero Moya</ion-card-subtitle>
              </ion-card-header>
            </div>

            <div class="icon-container-v2">
              <ion-icon color="danger" name="trash" class="icon-size"></ion-icon>
            </div>
          </ion-card>

          <ion-card color="light" class="fixed-margin-card-modal">
            <div class="icon-container">
              <ion-icon name="accessibility" class="icon-size"></ion-icon>
            </div>
            
            <div class="text-container">
              <ion-card-header class="ion-text-center">
                <ion-card-subtitle>Alejandro Díaz Raygoza</ion-card-subtitle>
              </ion-card-header>
            </div>

            <div class="icon-container-v2">
              <ion-icon color="danger" name="trash" class="icon-size"></ion-icon>
            </div>
          </ion-card>

          <ion-card color="light" class="fixed-margin-card-modal">
            <div class="icon-container">
              <ion-icon name="accessibility" class="icon-size"></ion-icon>
            </div>
            
            <div class="text-container">
              <ion-card-header class="ion-text-center">
                <ion-card-subtitle>Carlos Daniel Medina Sahagún</ion-card-subtitle>
              </ion-card-header>
            </div>

            <div class="icon-container-v2">
              <ion-icon color="danger" name="trash" class="icon-size"></ion-icon>
            </div>
          </ion-card>
        </ion-content>
      </ng-template>
    </ion-modal>

    <!-- AGM 30/01/2024 - Modal para mostrar los grupos registrados por el maestro en el sistema -->
    <ion-modal [isOpen]="isFifthModalOpen">
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-icon name="arrow-back-outline" class="icon-modal-left" (click)="setFifthOpen(false)"></ion-icon>
            <ion-title class="ion-text-center">Grupos creados</ion-title>
          </ion-toolbar>
        </ion-header>
        
        <ion-content class="ion-padding ion-text-center">
          <!-- Iterar sobre los grupos con *ngFor -->
          <ion-card color="light" class="fixed-margin-card-modal" *ngFor="let grupo of grupos">
            <div class="icon-container">
              <ion-icon name="people-outline" class="icon-size"></ion-icon>
            </div>
            
            <div class="text-container">
              <ion-card-header class="ion-text-center">
                <ion-text color="primary">
                  <ion-card-title>{{ grupo.nombre }}</ion-card-title>
                </ion-text>
                <ion-card-subtitle>{{ grupo.descripcion }}</ion-card-subtitle>
              </ion-card-header>
            </div>
          
            <div class="icons-right-container">
              <ion-icon (click)="prepareEditGroup(grupo.id)" color="warning" name="pencil-sharp" class="icon-size-v3"></ion-icon>
              <ion-icon (click)="confirmDeletion(grupo.id)" color="danger" name="trash" class="icon-size-v3"></ion-icon>
            </div>
          
            <div class="icon-container-v2">
              <ion-icon name="chevron-forward-outline" class="icon-size-v3" (click)="goToGroup(grupo.id)"></ion-icon>
            </div>
          </ion-card>
        </ion-content>
      </ng-template>
    </ion-modal>

    <!-- AGM 30/01/2024 - Modal para modificar el grupo -->
    <ion-modal [isOpen]="isSixthModalOpen">
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-icon name="arrow-back-outline" class="icon-modal-left" (click)="setSixthOpen(false)"></ion-icon>
          </ion-toolbar>
        </ion-header>
        <ion-content class="ion-padding ion-text-center">
          <h1>Modificar propiedades del grupo</h1>

          <ion-item class="separator">
            <ion-input placeholder="Nombre del grupo" [(ngModel)]="selectedGroup.nombre"></ion-input>
          </ion-item>
          
          <ion-item>
            <ion-input placeholder="Descripción del grupo" [(ngModel)]="selectedGroup.descripcion"></ion-input>
          </ion-item>

          <!-- Mostrar mensaje de error si existe -->
          <ion-text class="ion-text-center" color="danger" *ngIf="errorMessage">
            <p>{{ errorMessage }}</p>
          </ion-text>

          <ion-button class="btn-cancelar" (click)="setSixthOpen(false)" color="danger">Cancelar</ion-button>
          <ion-button class="btn-registrar" (click)="showEditConfirmation()" color="warning">Modificar</ion-button>        
        </ion-content>
      </ng-template>
    </ion-modal> 
  </div>
</ion-content>